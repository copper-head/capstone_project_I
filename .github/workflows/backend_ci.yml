name: Backend CI

on:
	push:
		branches:
			- "**"
	pull_request:
		branches:
			- "**"

jobs:
	test:
		runs-on: ubuntu-latest

		steps:
			- name: Checkout repository
				uses: actions/checkout@v4

			- name: Set up Python
				uses: actions/setup-python@v5
				with:
					python-version: "3.13"
					cache: "pip"
					cache-dependency-path: |
						backend/requirements.txt

			- name: Install dependencies
				run: |
					python -m pip install --upgrade pip
					pip install -r backend/requirements.txt

			- name: Run backend tests
				env:
					DISABLE_DB_INIT: "1"
				run: |
					python -m pytest -q backend/tests
